container_commands:
  10_migrate:
    command: >
      source /opt/python/run/venv/bin/activate &&
      python manage.py migrate --noinput
    leader_only: true

  20_create_admin:
    command: >
      source /opt/python/run/venv/bin/activate &&
      python manage.py createsu
    leader_only: true

  30_collectstatic:
    command: >
      source /opt/python/run/venv/bin/activate &&
      python manage.py collectstatic --noinput &> /tmp/collectstatic-output

  40_create_log_directory:
    command: >
      sudo mkdir -p /opt/python/log/data_import

  50_set_log_directory_permissions:
    command: >
      sudo chown ec2-user:ec2-user /opt/python/log/data_import
      sudo chmod 755 /opt/python/log/data_import
